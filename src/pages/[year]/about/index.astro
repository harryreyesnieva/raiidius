---
import BaseLayout from "../../../layouts/BaseLayout.astro";
import ComingSoonBanner from "../../../components/ComingSoonBanner.astro";
import Card from "../../../components/ui/Card.astro";
import Badge from "../../../components/ui/Badge.astro";
import Separator from "../../../components/ui/Separator.astro";
import Button from "../../../components/ui/Button.astro";
import Icon from "../../../components/Icon.astro";
import { siteConfig, getEdition } from "../../../content/siteConfig";
import { getEditionYears } from "../../../lib/editions";

export async function getStaticPaths() {
  return getEditionYears().map((year) => ({ params: { year: String(year) } }));
}

const year = Number(Astro.params.year);
const edition = getEdition(year) ?? siteConfig.editions[0];
const outcomes = edition.outcomes ?? [];
const committee = edition.committee ?? [];
---
<BaseLayout year={year} title="About" description={`About ${siteConfig.seriesAcronym} and the ${edition.year} edition.`}>
  <section class="border-b border-border px-4 py-12 lg:px-6">
    <div class="mx-auto max-w-7xl">
      <div class="flex flex-col gap-2">
        <h1 class="text-3xl font-bold text-foreground">About</h1>
        <p class="text-sm text-muted-foreground">
          {siteConfig.seriesAcronym} is an annual symposium focused on responsible AI, data science, and informatics for infectious diseasesâ€”bridging research, implementation, and equity.
        </p>
      </div>

      {edition.isComingSoon ? (
        <div class="mt-6">
          <ComingSoonBanner year={edition.year} theme={edition.themeTitle} />
        </div>
      ) : null}

      <div class="mt-10 grid gap-6 lg:grid-cols-3">
        <div class="lg:col-span-2">
          <Card>
            <div class="p-6">
              <div class="text-sm font-semibold text-foreground">Series mission</div>
              <p class="mt-2 text-sm text-muted-foreground">
                {siteConfig.seriesDescription}
              </p>

              <Separator class="my-6" />

              <div class="text-sm font-semibold text-foreground">{edition.year} edition</div>
              <div class="mt-2 flex flex-wrap gap-2">
                <Badge variant="secondary">Theme: {edition.themeShortTitle}</Badge>
                <Badge variant="outline">{edition.hostCampus}</Badge>
              </div>
              <p class="mt-3 text-sm text-muted-foreground">{edition.themeDescription}</p>

              <Separator class="my-6" />

              <div class="text-sm font-semibold text-foreground">Outcomes</div>
              {outcomes.length ? (
                <div class="mt-3 grid gap-3 md:grid-cols-2">
                  {outcomes.map((o) => (
                    <div class="rounded-lg border border-border bg-background p-4">
                      <div class="text-sm font-semibold text-foreground">{o.title}</div>
                      <p class="mt-1 text-sm text-muted-foreground">{o.description}</p>
                    </div>
                  ))}
                </div>
              ) : (
                <p class="mt-2 text-sm text-muted-foreground">Outcomes will be posted here.</p>
              )}
            </div>
          </Card>
        </div>

        <aside class="grid gap-4">
          <Card>
            <div class="p-6">
              <div class="text-sm font-semibold text-foreground">Organizing committee</div>
              {committee.length ? (
                <ul class="mt-3 grid gap-3 text-sm text-muted-foreground">
                  {committee.map((m) => (
                    <li>
                      <div class="font-medium text-foreground">{m.name}</div>
                      <div>{m.title}</div>
                      <div class="text-xs">{m.affiliation}</div>
                    </li>
                  ))}
                </ul>
              ) : (
                <p class="mt-2 text-sm text-muted-foreground">Committee details coming soon.</p>
              )}
            </div>
          </Card>

          <div class="rounded-lg border border-border bg-primary/5 p-6">
            <div class="text-sm font-semibold text-foreground">Code of Conduct</div>
            <p class="mt-2 text-sm text-muted-foreground">
              We are committed to a welcoming and respectful environment.
            </p>
            <div class="mt-4">
              <Button href={`${import.meta.env.BASE_URL}${year}/code-of-conduct/`} variant="outline">
                Read the Code of Conduct
                <Icon name="ArrowRight" class="h-4 w-4" />
              </Button>
            </div>
          </div>
        </aside>
      </div>
    </div>
  </section>
</BaseLayout>
