---
import { siteConfig } from "../../content/siteConfig";
import type { Edition } from "../../content/types";
import Button from "../ui/Button.astro";
import Badge from "../ui/Badge.astro";
import Icon from "../Icon.astro";

export interface Props {
  edition: Edition;
}

const { edition } = Astro.props;

const canRegister = Boolean(edition.registrationUrl) && !edition.isComingSoon;
const canSubmit = Boolean(edition.submissionUrl) && !edition.isComingSoon;
const hasDate = Boolean(edition.dateISO);
const calendarHref = `${import.meta.env.BASE_URL}calendar/RAIIDIUS-${edition.year}.ics`;
---
<section class="border-b border-border px-4 py-16 lg:px-6">
  <div class="mx-auto max-w-7xl text-center">
    <div class="mx-auto max-w-3xl">
      <h1 class="text-4xl font-bold tracking-tight text-foreground sm:text-5xl">
        {siteConfig.seriesAcronym}
      </h1>
      <p class="mx-auto mt-3 max-w-3xl text-balance text-base leading-relaxed text-muted-foreground sm:text-lg">
        {siteConfig.seriesFullName}
      </p>

      <div class="mt-8 inline-flex items-center gap-2 rounded-full border border-primary/20 bg-primary/5 px-5 py-2 text-sm font-medium text-primary">
        <span>{siteConfig.seriesAcronym} {edition.year}</span>
        <span class="text-primary/40">|</span>
        <span>Theme: {edition.themeShortTitle}</span>
      </div>

      {hasDate ? (
        <div class="mt-6 flex flex-col items-center justify-center gap-3 text-sm text-muted-foreground sm:flex-row">
          <div class="inline-flex items-center gap-2">
            <Icon name="CalendarDays" class="h-4 w-4 text-primary" />
            <span>{edition.date} • {edition.timezone === "America/New_York" ? "ET" : edition.timezone}</span>
          </div>
          <span class="hidden sm:inline text-muted-foreground/40">•</span>
          <div class="inline-flex items-center gap-2">
            <Icon name="MapPin" class="h-4 w-4 text-primary" />
            <span>{edition.room} • {edition.address}, {edition.city}, {edition.state}</span>
          </div>
        </div>
      ) : (
        <div class="mt-6 text-sm text-muted-foreground">
          Details forthcoming.
        </div>
      )}

      <div class="mt-10 flex flex-col items-center justify-center gap-3 sm:flex-row">
        <Button href={canRegister ? edition.registrationUrl : undefined} disabled={!canRegister} variant="primary">
          Register
        </Button>
        <Button href={canSubmit ? edition.submissionUrl : undefined} disabled={!canSubmit} variant="outline">
          Submit Abstract/Poster
        </Button>
        <Button href={calendarHref} variant="ghost">
          <Icon name="CalendarDays" class="h-4 w-4" />
          Add to calendar
        </Button>
      </div>

      {edition.isComingSoon ? (
        <p class="mx-auto mt-6 max-w-2xl text-sm text-muted-foreground">
          This edition is listed as <strong>Coming soon</strong>. Join the mailing list to be notified when registration and submissions open.
        </p>
      ) : null}
    </div>
  </div>
</section>
