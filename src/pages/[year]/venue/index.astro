---
import BaseLayout from "../../../layouts/BaseLayout.astro";
import ComingSoonBanner from "../../../components/ComingSoonBanner.astro";
import Card from "../../../components/ui/Card.astro";
import Button from "../../../components/ui/Button.astro";
import Icon from "../../../components/Icon.astro";
import Separator from "../../../components/ui/Separator.astro";
import { siteConfig, getEdition } from "../../../content/siteConfig";
import { getEditionYears } from "../../../lib/editions";

export async function getStaticPaths() {
  return getEditionYears().map((year) => ({ params: { year: String(year) } }));
}

const year = Number(Astro.params.year);
const edition = getEdition(year) ?? siteConfig.editions[0];

const mapsQuery = encodeURIComponent(`${edition.venue}, ${edition.address}, ${edition.city}, ${edition.state} ${edition.zip}`);
const mapsUrl = `https://www.google.com/maps/search/?api=1&query=${mapsQuery}`;
---
<BaseLayout year={year} title="Venue" description={`Venue and logistics for ${siteConfig.seriesAcronym} ${edition.year}.`}>
  <section class="border-b border-border px-4 py-12 lg:px-6">
    <div class="mx-auto max-w-7xl">
      <div class="flex flex-col gap-4 md:flex-row md:items-end md:justify-between">
        <div>
          <h1 class="text-3xl font-bold text-foreground">Venue</h1>
          <p class="mt-2 text-sm text-muted-foreground">
            {edition.venue} • {edition.room}
          </p>
        </div>
        <div class="print:hidden">
          <Button href={mapsUrl} target="_blank" rel="noreferrer" variant="outline">
            <Icon name="MapPin" class="h-4 w-4" />
            Open in Maps
          </Button>
        </div>
      </div>

      {edition.isComingSoon ? (
        <div class="mt-6">
          <ComingSoonBanner year={edition.year} theme={edition.themeTitle} />
        </div>
      ) : null}

      <div class="mt-10 grid gap-6 lg:grid-cols-3">
        <div class="lg:col-span-2">
          <Card>
            <div class="p-6">
              <div class="text-sm font-semibold text-foreground">Address</div>
              <p class="mt-2 text-sm text-muted-foreground">
                {edition.address}<br />
                {edition.city}, {edition.state} {edition.zip}<br />
                {edition.country}
              </p>

              <Separator class="my-6" />

              <div class="text-sm font-semibold text-foreground">Directions (placeholders)</div>
              <ul class="mt-3 grid gap-2 text-sm text-muted-foreground">
                <li>• Subway: Add nearest lines/stops here.</li>
                <li>• Bus: Add routes here.</li>
                <li>• Parking: Add options here.</li>
                <li>• Building entry: Add check-in instructions here.</li>
              </ul>

              <Separator class="my-6" />

              <div class="text-sm font-semibold text-foreground">Accessibility & accommodations</div>
              <p class="mt-2 text-sm text-muted-foreground">
                We aim to host an inclusive event. If you have accessibility needs, dietary restrictions, or require accommodations, email
                <a class="ml-1 underline underline-offset-4 hover:text-foreground" href={`mailto:${edition.contactEmail}`}>{edition.contactEmail}</a>.
              </p>
            </div>
          </Card>
        </div>

        <aside class="grid gap-4">
          <Card>
            <div class="p-6">
              <div class="text-sm font-semibold text-foreground">On-site schedule</div>
              <p class="mt-2 text-sm text-muted-foreground">
                Registration opens at <span class="font-medium text-foreground">8:00 AM</span>. See the program page for full details.
              </p>
              <div class="mt-4">
                <Button href={`${import.meta.env.BASE_URL}${year}/program/`} variant="outline">
                  View program
                  <Icon name="ArrowRight" class="h-4 w-4" />
                </Button>
              </div>
            </div>
          </Card>

          <div class="rounded-lg border border-border bg-primary/5 p-6">
            <div class="text-sm font-semibold text-foreground">Contact</div>
            <p class="mt-2 text-sm text-muted-foreground">
              Questions about travel/logistics? Email <a class="underline underline-offset-4 hover:text-foreground" href={`mailto:${edition.contactEmail}`}>{edition.contactEmail}</a>.
            </p>
          </div>
        </aside>
      </div>
    </div>
  </section>
</BaseLayout>
